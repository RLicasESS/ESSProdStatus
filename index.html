<!DOCTYPE html>
<html>
<head>
  <title>ESSProdStatus</title>
  <style>
    table {
      border-collapse: collapse;
      width: 60%;
      margin: 20px auto;
      font-family: Arial, sans-serif;
    }
    th, td {
      border: 1px solid #aaa;
      padding: 8px 12px;
      text-align: left;
    }
    th {
      background-color: #2c3e50;  /* Dark blue-gray header */
      color: white;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <h2 style="text-align: center;">ESS PRODUCTION</h2>

<script>
  async function loadCSV() {
    const response = await fetch('ESSProd.csv?v=' + new Date().getTime());
    const text = await response.text();

    const rows = text.trim().split('\n').map(row => row.split(','));
    const table = document.createElement('table');
    table.style.borderCollapse = 'collapse';
    table.style.margin = '0 auto';
    table.style.fontFamily = 'Arial, sans-serif';

    rows.forEach((row, rowIndex) => {
      <!-- const nonEmptyCount = row.filter(cell => cell.trim() !== '').length; -->
      const nonEmptyCount = row.filter(cell => {
        const c = cell.trim().toUpperCase();
        return c !== '' && c !== 'NA';
      }).length;
    
      <!-- if (nonEmptyCount < row.length / 2) return; -->
      if (nonEmptyCount === 0) return; // skip only if all are empty or NA
      const tr = document.createElement('tr');
      const isHeader = rowIndex === 0;
      const isTesterOrHandlerRow = !isHeader && row.some(cell => /tester|handler/i.test(cell));

      row.forEach((cell, colIndex) => {
        const cellElement = document.createElement(isHeader ? 'th' : 'td');
        cellElement.textContent = cell;
        cellElement.style.border = '1px solid #aaa';
        cellElement.style.padding = '8px';

        if (colIndex === 0) {
          cellElement.style.backgroundColor = isHeader ? '#2c3e50' : '#dff0d8';
          if (isHeader) {
            cellElement.style.color = 'white';
            cellElement.style.fontWeight = 'bold';
          }
        }

        if (isTesterOrHandlerRow && !isHeader) {
          cellElement.style.backgroundColor = '#fef2d0';
        }

        tr.appendChild(cellElement);
      });

      table.appendChild(tr);
    });

    const oldTable = document.querySelector('table');
    if (oldTable) oldTable.remove();
    document.body.appendChild(table);
  }

  window.onload = () => {
    loadCSV();
    setInterval(loadCSV, 60000); // refresh every 60 seconds
  };
</script>
  

</body>
</html>





