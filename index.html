<!DOCTYPE html>
<html>
<head>
  <title>ESSProdStatus</title>
  
  <style>
    table {
      border-collapse: collapse;
      width: 60%;
      margin: 20px auto;
    }
    th, td {
      border: 1px solid #aaa;
      padding: 8px 12px;
      text-align: left;
    }
    th {
      background-color: #f0f0f0;
    }
  </style>



</head>
<body>

  <h2 style="text-align: center;">ESS HANDLERS</h2>
  <input type="file" id="fileInput" accept=".csv" multiple>
  <button onclick="combineCSVs()">Combine and Display</button>

  <div id="tableContainer"></div>

  <script>
    function combineCSVs() {
      const files = document.getElementById('fileInput').files;
      if (files.length === 0) {
        alert("Please select CSV files first.");
        return;
      }

      let combinedRows = [];
      let header = null;
      let filesProcessed = 0;

      Array.from(files).forEach((file, idx) => {
        const reader = new FileReader();
        reader.onload = function (e) {
          const lines = e.target.result.trim().split('\n').map(line => line.split(','));
          if (!header) {
            header = lines[0];
            combinedRows.push(header);
          }
          combinedRows.push(...lines.slice(1));
          filesProcessed++;
          if (filesProcessed === files.length) {
            displayTable(combinedRows);
          }
        };
        reader.readAsText(file);
      });
    }

    function displayTable(rows) {
      const table = document.createElement('table');
      rows.forEach((row, i) => {
        const tr = document.createElement('tr');
        row.forEach(cell => {
          const td = document.createElement(i === 0 ? 'th' : 'td');
          td.textContent = cell;
          tr.appendChild(td);
        });
        table.appendChild(tr);
      });

      const container = document.getElementById('tableContainer');
      container.innerHTML = ""; // Clear previous table
      container.appendChild(table);
    }
  </script>


  <h2 style="text-align: center;">ESS TESTERS</h2>

  <script>
    async function loadCSV() {
      const response = await fetch('ESSTesters.csv');
      const text = await response.text();

      const rows = text.trim().split('\n').map(row => row.split(','));
      const table = document.createElement('table');
      table.border = 1;

      for (let row of rows) {

    	const nonEmptyCount = row.filter(cell => cell.trim() !== '').length;
    	if (nonEmptyCount < row.length / 2) continue;  // skip if more than half are blank


        const tr = document.createElement('tr');
        for (let cell of row) {
          const td = document.createElement('td');
          td.textContent = cell;
          tr.appendChild(td);
        }
        table.appendChild(tr);
      }

      document.body.appendChild(table);
    }

    window.onload = loadCSV;
  </script>



</body>
</html>
